CREATE TABLE KHACHHANG
(
	MaKH INTEGER NOT NULL,
	TenKH VARCHAR(255) NOT NULL,
	DiaChi VARCHAR(255),
	SDT INTEGER,
	Email VARCHAR(255),
	TongNo MONEY,
	CONSTRAINT PK_KH PRIMARY KEY (MaKH)
)
CREATE TABLE THELOAI
(
	MaTL INTEGER NOT NULL,
	TenTL VARCHAR(255),
	CONSTRAINT PK_TL PRIMARY KEY (MaTL)
)
CREATE TABLE SACH
(
	MaSach INTEGER NOT NULL,
	TenSach VARCHAR(255),
	MaTL INTEGER NOT NULL,
	TacGia VARCHAR(255),
	SoLuongTon INTEGER,
	DonGiaBan FLOAT,
	DonGiaNhap FLOAT,
	CONSTRAINT PK_SACH PRIMARY KEY (MaSach)
)
CREATE TABLE PHIEUTHUTIEN
(
	SoPTT INTEGER NOT NULL,
	MaKH INTEGER NOT NULL,
	NgayThuTien DATETIME,
	SoTienThu MONEY,
	CONSTRAINT PK_PHIEUTHUTIEN PRIMARY KEY (SoPTT)
)
CREATE TABLE HOADON
(
	SoHD INTEGER NOT NULL PRIMARY KEY,
	NgayLap DATETIME NOT NULL,
	TongTien MONEY NOT NULL,
)	
CREATE TABLE CTHD
(
	SoHD INTEGER NOT NULL,
	MaKH INTEGER NOT NULL,
	MaSach INTEGER NOT NULL,
	SoLuongBan INTEGER,
	DonGiaBan MONEY,
	ThanhTien MONEY,
	TienTra MONEY,
	CONSTRAINT PK_CTHD PRIMARY KEY (SoHD,MaKH,MaSach)
)
CREATE TABLE PHIEUNHAPSACH
(
	SoPN INTEGER NOT NULL PRIMARY KEY,
	NgayNhap DATETIME,
)
CREATE TABLE CTPNS
(
	SoPN INTEGER  NOT NULL,
	MaSach INTEGER NOT NULL,
	MaCTPNS INTEGER NOT NULL,
	SoLuongNhap INTEGER NOT NULL,
	DonGiaNhap MONEY NOT NULL,
	CONSTRAINT PK_CTPNS PRIMARY KEY (SoPN,MaSach,MaCTPNS)
)
CREATE TABLE BAOCAOTON
(
	Thang INTEGER NOT NULL,
	Nam INTEGER NOT NULL,
	MaSach INTEGER NOT NULL,
	TonDau MONEY,
	PhatSinh MONEY,
	TonCuoi MONEY,
	CONSTRAINT PK_BAOCAOTON PRIMARY KEY (Thang,Nam,MaSach)
)
CREATE TABLE BAOCAOCONGNO
(
	Thang INTEGER NOT NULL,
	Nam INTEGER NOT NULL,
	MaKH INTEGER NOT NULL,
	NoDau MONEY,
	PhatSinh MONEY,
	NoCuoi MONEY,
	CONSTRAINT PK_BAOCAOCONGNO PRIMARY KEY (Thang,Nam,MaKH)
)
CREATE TABLE QUYDINH
(
	SoLuongNhapToiThieu INTEGER,
	SoLuongTonToiThieu INTEGER,
	SoNoToiD MONEY,
	TiLeTinhDonGiaBa INTEGER,
	KiemTraSoTienTh INTEGER,
)

INSERT INTO KHACHHANG VALUES (1, 'Huỳnh Chí Phong', '792/4 đường Kha Vạn Cân, phường Linh Đông, quận Thủ Đức, tp Hồ Chí Minh', 01203875665, 'phong12345@gmail.com', 120000);
INSERT INTO KHACHHANG VALUES (2, 'Võ Hoài Nam', '296 Tô Ngọc Vân, phường Linh Đông, quận Thủ Đức, tp Hồ Chí Minh', 0909928956, 'namksqt@gmail.com', 0);
INSERT INTO KHACHHANG VALUES (3, 'Tô Chính Tín', 'ký túc xá khu A, phường Linh Trung, quận Thủ Đức, tp Hồ Chí Minh', 01694254261, 'tinchiiu@gmail.com', 200000);
INSERT INTO KHACHHANG VALUES (4, 'Lãnh Thừa Phong', 'ký túc xá khu A, phường Linh Trung, quận Thủ Đức, tp Hồ Chí Minh', 0946330245, 'thuaphong@gmail.com', 300000);
INSERT INTO KHACHHANG VALUES (5, 'Lý Thất Dạ', '7b/5 Thành Thái, quận 10, tp Hồ Chí Minh', 0369001344, 'nhedacatin@gmail.com', 0);
INSERT INTO KHACHHANG VALUES (6, 'Mai Thị Lan Chi', '10 Nguyễn Thị Minh Khai, quận 1, tp Hồ Chí Minh', 0905880148, 'chidepgai@gmail.com', 0);
INSERT INTO KHACHHANG VALUES (7, 'Nguyễn Hoàng Nam', 'Tòa nhà Biteco, quận 1, tp Hồ Chí Minh', 0977422748, 'namtxqt@gmail.com', 520000);
INSERT INTO KHACHHANG VALUES (8, 'Nguyễn Minh Đức', '16 Nguyễn Gia Trí, quận Bình Thạnh, tp Hồ Chí Minh', 0908536542, 'duccuto@gmail.com', 90000);
INSERT INTO KHACHHANG VALUES (9, 'Lưu Thị Liên', '24 Khuông Việt, quận Tân Bình, tp Hồ Chí Minh', 0745124524, 'lienha@gmail.com', 50000);
INSERT INTO KHACHHANG VALUES (10, 'Nguyễn Trần Trung Đan', '16 Bạch Đằng, quận Tân BÌnh, tp Hồ Chí Minh', 0356206309, 'dantay@gmail.com', 100000);


INSERT INTO THELOAI VALUES (1, 'Trinh Thám');
INSERT INTO THELOAI VALUES (2, 'Kinh dị');
INSERT INTO THELOAI VALUES (3, 'Sách Giáo Khoa');
INSERT INTO THELOAI VALUES (4, 'Lãng Mạng');
INSERT INTO THELOAI VALUES (5, 'Học Trò');
INSERT INTO THELOAI VALUES (6, 'Thiếu Nhi');
INSERT INTO THELOAI VALUES (7, 'Thể Thao');
INSERT INTO THELOAI VALUES (8, 'Hư Cấu');
INSERT INTO THELOAI VALUES (9, 'Truyện Tranh');
INSERT INTO THELOAI VALUES (10, 'Ngôn Tình');
INSERT INTO THELOAI VALUES (11, 'Khoa Học Giả Tưởng');
INSERT INTO THELOAI VALUES (12, 'Sách Học Ngoại Ngữ');
INSERT INTO THELOAI VALUES (13, 'Sách Thường Thức - Đời Sống');
INSERT INTO THELOAI VALUES (14, 'Sách Văn Học - Truyện Ngắn - Tiểu Thuyết');
INSERT INTO THELOAI VALUES (15, 'Từ Điển');

INSERT INTO SACH VALUES (1, 'Kính Vạn Hoa', 5, 'Nguyễn Nhật Ánh', 342, 30000, 20000);
INSERT INTO SACH VALUES (2, 'Mật mã Da Vinci', 1, 'Dan Brown', 52, 200000, 100000);
INSERT INTO SACH VALUES (3, 'Sherlock Holmes', 1, 'Arthur Conan Doyle', 100, 1000000, 500000);
INSERT INTO SACH VALUES (4, 'Sự im lặng của bầy cừu', 1, 'Thomas Harris', 112, 300000, 200000);
INSERT INTO SACH VALUES (5, 'Tấm Vải Đỏ', 2, 'Hồng Nương Tử', 13, 500000, 200000);
INSERT INTO SACH VALUES (6, 'Địa Ngục Tầng Thứ 19', 2, 'Sái Tuấn', 50, 300000, 200000);	
INSERT INTO SACH VALUES (7, 'Người Tìm Xác', 5, 'Lạc Lâm Lang', 90, 50000, 20000);
INSERT INTO SACH VALUES (8, 'Toán 11', 3, 'Bộ Giáo dục và Đào tạo', 100, 15000, 10000);
INSERT INTO SACH VALUES (9, 'Ngữ Văn 12', 3, 'Bộ Giáo dục và Đào tạo', 302, 10000, 7000);
INSERT INTO SACH VALUES (10, 'Tiếng Anh 11', 3, 'Bộ Giáo dục và Đào tạo', 200, 15000, 10000);
INSERT INTO SACH VALUES (11, 'Trà Hoa Nữ', 4, 'Alexandre Dumas', 301, 300000, 200000);
INSERT INTO SACH VALUES (12, 'Gọi Em Bằng Tên Anh', 4, 'André Aciman', 222, 30000, 20000);
INSERT INTO SACH VALUES (13, 'Rừng Nauy', 4, 'Haruki Murakami', 190, 300000, 200000);
INSERT INTO SACH VALUES (14, 'Cho tôi xin một vé đi tuổi thơ', 5, 'Nguyễn Nhật Ánh', 342, 300000, 150000);
INSERT INTO SACH VALUES (15, 'Chiến binh cầu vồng', 5, 'Andrea Hirata', 524, 300000, 200000);
INSERT INTO SACH VALUES (16, 'Năm tháng vội vã', 5, 'Nguyễn Nhật Ánh', 195, 300000, 200000);
INSERT INTO SACH VALUES (17, 'Ubik', 11, 'Philip K. Dick', 321, 320000, 260000);
INSERT INTO SACH VALUES (18, 'Dune', 11, 'Frank Herbert', 412, 300000, 200000);
INSERT INTO SACH VALUES (19, 'Labyrinths', 11, 'Jorge Luis Borges', 246, 300000, 200000);
INSERT INTO SACH VALUES (20, '1984', 11, 'George Orwell', 123, 300000, 200000);

INSERT INTO PHIEUTHUTIEN VALUES (1, 1, '2023/1/26', 100000);
INSERT INTO PHIEUTHUTIEN VALUES (2, 2, '2023/1/26', 300000);
INSERT INTO PHIEUTHUTIEN VALUES (3, 3, '2023/1/26', 150000);
INSERT INTO PHIEUTHUTIEN VALUES (4, 1, '2023/2/12', 2000000);
INSERT INTO PHIEUTHUTIEN VALUES (5, 5, '2023/2/12', 100000);
INSERT INTO PHIEUTHUTIEN VALUES (6, 7, '2023/2/12', 90000);
INSERT INTO PHIEUTHUTIEN VALUES (7, 8, '2023/3/6', 80000);
INSERT INTO PHIEUTHUTIEN VALUES (8, 3, '2023/3/6', 120000);
INSERT INTO PHIEUTHUTIEN VALUES (9, 2, '2023/3/6', 100000);
INSERT INTO PHIEUTHUTIEN VALUES (10, 9, '2023/3/26', 200000);



INSERT INTO PHIEUNHAPSACH VALUES (1, '2022/12/20');
INSERT INTO PHIEUNHAPSACH VALUES (2, '2023/1/2');
INSERT INTO PHIEUNHAPSACH VALUES (3, '2023/1/15');
INSERT INTO PHIEUNHAPSACH VALUES (4, '2023/2/2');
INSERT INTO PHIEUNHAPSACH VALUES (5, '2023/2/15');

INSERT INTO CTPNS VALUES (1, 1, 1, 200, 20000);
INSERT INTO CTPNS VALUES (1, 2, 2, 30, 100000);
INSERT INTO CTPNS VALUES (1, 3, 3, 50, 500000);
INSERT INTO CTPNS VALUES (2, 4, 4, 50, 200000);
INSERT INTO CTPNS VALUES (2, 8, 5, 200, 10000);
INSERT INTO CTPNS VALUES (3, 1, 6, 50, 20000);
INSERT INTO CTPNS VALUES (3, 9, 7, 200, 7000);
INSERT INTO CTPNS VALUES (4, 18, 8, 100, 200000);
INSERT INTO CTPNS VALUES (5, 19, 9, 100, 200000);

INSERT INTO BAOCAOTON VALUES (3, 2023, 1, 50, 20, 70);
INSERT INTO BAOCAOTON VALUES (2, 2023, 4, 50, 20, 70);

INSERT INTO BAOCAOCONGNO VALUES (2, 2023, 1, 200, 0, 200);

INSERT INTO QUYDINH VALUES (150, 300, 20000, 105, 100000);



ALTER TABLE SACH 
ADD CONSTRAINT FK_SACH_THELOAI FOREIGN KEY (MaTL) REFERENCES THELOAI(MaTL)

ALTER TABLE CTHD ADD 
CONSTRAINT FK_CTHD_HOADON FOREIGN KEY (SoHD) REFERENCES HOADON(SoHD),
CONSTRAINT FK_CTHD_KHACHHANG FOREIGN KEY (MaKH) REFERENCES KHACHHANG(MaKH),
CONSTRAINT FK_CTHD_SACH FOREIGN KEY (MaSach) REFERENCES SACH(MaSach)

ALTER TABLE CTPNS ADD 
CONSTRAINT FK_CTPNS_PHIEUNHAPSACH FOREIGN KEY (SoPN) REFERENCES PHIEUNHAPSACH(SoPN),
CONSTRAINT FK_CTPNS_SACH FOREIGN KEY (MaSach) REFERENCES SACH(MaSach)

ALTER TABLE PHIEUTHUTIEN ADD CONSTRAINT FK_PHIEUTHUTIEN_KHACHANG FOREIGN KEY (MaKH) REFERENCES KHACHANG(MaKH)

ALTER TABLE BAOCAOTON ADD CONSTRAINT FK_BAOCAOTON_SACH FOREIGN KEY (MaSach) REFERENCES SACH(MaSach)

ALTER TABLE BAOCAOCONGNO ADD CONSTRAINT FK_MaKH_BAOCAOCONGNO_KHACHHANG FOREIGN KEY (MaKH) REFERENCES KHACHHANG(MaKH)
